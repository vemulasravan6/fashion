wget -O pompom-ballerinas-c1094517p500629982.html -q https://www.lefties.com/sa/girls/shoes/pompom-ballerinas-c1094517p500629982.html
<!doctype html>
<html>
	<head>
		<!-- begin pre-common head -->
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta http-equiv="x-ua-compatible" content="ie=edge" /> 

<meta content="pompom ballerinas for only 55 in lefties. visit now and discover our shoes collection." name="description">
<title>pompom ballerinas - shoes - girls - | lefties  saudi arabia</title>
<link rel="canonical" href="https://www.lefties.com/sa/girls/shoes/pompom-ballerinas-c1094517p500629982.html" />
<meta http-equiv="content-language" content="en-sa"><meta property="og:title" content="pompom ballerinas - shoes - girls - | lefties  saudi arabia" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://static.lefties.com/9/photos//2018/v/1/3/p/4415/393/020/4415393020_1_1_3.jpg?t=ts" />
<meta property="og:url" content="https://www.lefties.com/sa/girls/shoes/pompom-ballerinas-c1094517p500629982.html" />
<meta property="og:description" content="pompom ballerinas for only 55 in lefties. visit now and discover our shoes collection." /><meta property="twitter:card" content="summary">
<meta property="twitter:site" content="@leftiesofficial"/>
<meta property="twitter:title" content="pompom ballerinas - shoes - girls - | lefties  saudi arabia"/>
<meta property="twitter:description" content="pompom ballerinas for only 55 in lefties. visit now and discover our shoes collection."/>
<meta property="twitter:image" content="https://static.lefties.com/9/photos//2018/v/1/3/p/4415/393/020/4415393020_1_1_3.jpg?t=ts"/><link rel="image_src" href="https://static.lefties.com/9/static/itxwebstandard/logo/logo.png?t=201803190355001913109886" />
<!-- begin spot=lf2_espot_headbegin -->

<!-- end spot=lf2_espot_headbegin -->

<!-- begin spot=lf2_espot_productpagehead -->

<!-- end spot=lf2_espot_productpagehead -->

<link rel="stylesheet" type="text/css" href="/static/itxwebstandard/css/itx-core-main.min.css?t=2018022111552116db1913109886" />
<link rel="stylesheet" type="text/css" href="https://static.lefties.com/9/static/itxwebstandard/css/itx-custom-main.min.css?t=201803190355001913109886" />
<script type="text/javascript" src="/static/itxwebstandard/js/itx-core-api.min.js?t=2018022111552116db1913109886"></script>
<script type="text/javascript" src="/static/itxwebstandard/js/95009030/-1/90009050/lf2_espot_i18n.min.js?t=201803190355001913109886"></script>

<!-- begin js attachments -->
<!-- end js attachments -->

<!-- begin css attachments -->
<!-- end css attachments -->


<script type="text/javascript">
	inditex.ibrand = "lefties";
	inditex.ibrandid = 9;
	inditex.iismobile = false;
	inditex.iismobileon = false;
	inditex.ipage = "itxproductpage";
	inditex.iparams = {"productid":["500629982"],"storeid":["95009030"],"categoryid":["1094517"]};
	inditex.istoreid = 95009030;
	inditex.istoreidentifier = "leftiessa";
	inditex.ilangid = -1;
	inditex.icatalogid = 90009050;
	inditex.ilayout = "itxwebstandard";
	inditex.iregistryts = "201803190355001913109886";
	inditex.icustomts = "2018022111552116db1913109886";
	inditex.iproxyhostmobile = "www.lefties.com";
	inditex.iproxyhoststandard = "www.lefties.com";
	inditex.iproxyportmobile = 80;
	inditex.iproxyportstandard = 80;
	inditex.iproxysecureportmobile = 443;
	inditex.iproxysecureportstandard = 443;
	inditex.iproxycontextpathmobile = "/m/";
	inditex.iproxycontextpathstandard = "/";
	inditex.isecureset = ["itxmyaccountorderdetailpage","itxstandardmyaccountlistpaymentcardpage","itxorderpaymentpage","itxmyaccounthomepage","itxmyaccountnewsletterpage","itxmyaccountpersonalpage","itxorderconfirmationpage","itxstandardajaxlogonpage","itxmyaccountorderspage","itxiframehelperpage","itxmyaccountrequestreturnpage","itxmyaccountaddressbookpage","itxstandarduserregistrationpage"];
	inditex.ilocale = "en_sa";
	inditex.icountrycode = "sa";
	inditex.icountryname = "saudi arabia";
	inditex.ispotprefix = "lf2_espot_";
	inditex.icategoryid = 1094517;
	inditex.icategorykey = "lefties_winter_shoes_girl";
	inditex.iproductid = 500629982;
	inditex.imaxlastproductlistlength = 10;
	inditex.iasyncpaymentpollingtries = 5;
	inditex.iasyncpaymentpollinginterval = 5000;
	inditex.igooglemapsuser = "gme-itxecommerceireland";
	inditex.igooglemapskey = "aizasybhn7fykhvtx-c2hppgsu2mjofuda67cfu";
	inditex.igooglemapschannel = "lefties";
	inditex.igakeyant = "ua-47574523-1";
	inditex.igakey1 = null;
	inditex.igakey2 = null;
    inditex.igoogleplaceskey = null;
    inditex.igoogleplacesenabled = false;
	inditex.igadomain = ".www.lefties.com";
	inditex.ienableuniversalanalytics = null;
	inditex.iappid = 1;
	inditex.iiswebresponsive = false;
	inditex.isolrpublicurlserver = "www.lefties.com/data";
	inditex.itmpurllangstandard = true;
	inditex.itmpurllangmobile = true;
	inditex.imaxproductsshopcart = 25;
	inditex.imaxproductswishlist = 1000;
	inditex.igooglemapsregexpublic = "^$";
	inditex.isecureenabled = true;
	inditex.ibaidumapskey = "";
	inditex.ibaiduhttps = true;
	inditex.imaplocationfromstoreenabled = true;
	inditex.isequencefromstockenabled = true;
    inditex.ienableoptimizelyanalyticsintegration = false;
    inditex.iparsemspotenabled = false;
    inditex.igooglemapsregion = false;
    inditex.igooglemapslanguage = false;
    inditex.isafecartenabled = false;
    inditex.impulseenabled = true;
    inditex.iproxyrestcontextpathmobile = "/itxrest/";
	inditex.iproxyrestcontextpathstandard = "/itxrest/";
	inditex.irestversion = "2";
	inditex.iremovecategoryrequest = false;
	inditex.iphysicalstore = null;
	inditex.icitystores = null;
	inditex.iunifiedproducturlenabled = false
</script>

<!-- google analytics -->
	<script type="text/javascript">
		var _gaq = _gaq || [];
		window['ga-disable-'+inditex.igakeyant] = true; 
		(function() {
			var ga = document.createelement('script');
			ga.type = 'text/javascript';
			ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getelementsbytagname('script')[0];
			s.parentnode.insertbefore(ga, s);
		})();
	</script>
<!-- end google analytics -->
<!-- end pre-common head -->
<!-- begin spot=lf2_espot_commoncontent -->
<script type="text/javascript">
	inditex.onready(function()
	{
		inditex.lflonglinefitproducts = [6807008,6807009,6807010,6807009,6807011];
	});
inditex.onready(function()
	{
		inditex.lfglowdarkproducts = [6869918,6870361,6870421];
	});
</script><script>

var popupfullscreen = new class({
  element:null,
  container:null,
  callback:null,
  closeel:null,

  initialize:function(_callback)
  {
    this.element=new element('div',{'id':'popupfullscreen'});
    this.closeel=new element('div',{'id':'close','html':inditex.lfplatformutils.getlanguagestring("close")}).inject(this.element);
    this.container=new element('div',{'id':'container'}).inject(this.element);
    this.element.setstyle('display','none');
    this.addevents();

    inditex.lflayout.layout_front.adopt(this.element);
    inditex.onresize(this.resize.bind(this))
  },
  show:function(_content)
  {
    inditex.lflayout.layout_front.setstyle('display','block');
    inditex.lflayout.layout_filter.setstyle('display','block');
    this.element.setstyle('display','block');
    $(document.body).setstyle('overflow','hidden');
    this.resize();
  },
  close:function()
  {
    inditex.lflayout.layout_front.setstyle('display','none');
    inditex.lflayout.layout_filter.setstyle('display','none');
    this.element.setstyle('display','none');
    $(document.body).setstyle('overflow','auto');

    if(this.callback!=null)
    {
      this.callback.apply();
      this.callback=null;
    }

  },
  addevents:function()
  {
    this.closeel.addevent('click',function()
    {
      this.close();
    }.bind(this));
  },
  load:function(_page,_evalscripts)
  {
    var self=this;
    ajaxhelper.requesthtml(
    {
      url: _page,
      evalscripts: false,
      onsuccess: function(responsetree, responseelements, responsehtml, responsejavascript)
      {
        this.container.set('html',responsehtml);
        if(_evalscripts) browser.exec(responsejavascript);
        this.show();
      }.bind(this)
    });
  },

  updatecontent:function(_content,_evalscripts)
  {
    this.container.empty();
    this.container.set('html',_content);
    if(_evalscripts!=null&&_evalscripts==true) _content.stripscripts(true);
    this.show();
  },
  updatecontentbyelement:function(_element)
  {
    this.container.empty();
    this.container.adopt(_element);
    this.show();
  },
  //callback que se ejecutar√° al cerrar el popup
  addcallback: function(_callback)
  {
    this.callback = _callback;
  },
  resize:function()
  {
    this.container.setstyle('height',window.getsize().y-114);
  }
});

inditex.onready(function() {
   if (inditex.ishomepage()) {
       
   }else{
       inditex.lfpopupfullscreen = new popupfullscreen();
  };
});



</script>

<script type="text/javascript">

salesconfiguratorjson=
{
  "doublemenu":
  {
    "1029506":{},
    "1032536":{},
    "1032538":{},
    "1094513":{},
    "1032545":{},
    "1032537":{},
    "1032544":{}
  },
  // "activatesales": ["ru","pt","mx","es"],
  "activatesales": [],
  "xsalespriority": true,
  "onlyncaftersales": [],
  "desactivaenviotienda": [],
  "salespriority": ["ru","pt","mx","es"],
  "activamensajenoenviotienda": [],
  "activamensajeplazoentrega": [],
  "muestraplazoenmenu": [],
  "hidesales": [],
  "activatepresales": [],
  "activatesaleskids": false,
  "salescategoriesidexcl":
  [
    "1041621","1029507","1041677","1344508","1041668","1041630","1041629","1041623","1041598","1506008","1038181","1029529","1032508","1194511","1344506", "1204502", "1041666", "1506007", "1506004", "1245511","1029507","1344506","1044501","1202022","1245509","1038056","1204506","1506006","1245508","1038177","1207013","1207014","1245501","1133023","1207015","1251512","1010046502","1041555","1134031","1135011","1041667","1041675","1335501","1135008","1135505","1135506","1038178","1038066","1172001"
  ],
  "nccategoriesidexcl":
  [
      "1342523","1166001","1038186","1041621","1041630","1204507","1506006","1038064","1038063","1032512","1032508","1029508","1330505","1032513","1335013","1038172","1506007","1038188","1506008","1041506","1342525","1041629","1041666","1041670","1344508","1041677","1342524","1041675","1032556","1506004","1319502","1032527","1319503","1330527","1044507","1041598","1041624","1041667","1041674","1202522","132572","1032578","1202022","1204506","1245509","1245511","1245508","1207013","1207014","1245501","1207015","1251512"
  ]
};

var salestextsjson =
{
  "msgsales":
  {
    "es": "rebajas",
    "en": "sale",
    "it": "saldi",
    "pt": "saldos",
    "fr": "soldes",
    "de": "schlussverkauf",
    "pl": "wyprzedaz",
    "gl": "rebaixas",
    "eu": "beherapenak",
    "ca": "rebaixes",
    "nl": "uitverkoop",
    "zh": "ÊäòÊâ£",
    "ro": "reduceri",
    "ru": "–°–ö–ò–î–ö–ò",
    "se": "rea"
  },
  "msgnc":
  {
    "es": "nueva colecci√ìn",
    "en": "new collection",
    "it": "nuova collezione",
    "pt": "nova cole√á√Éo",
    "fr": "nouvelle collection",
    "de": "neue kollektion",
    "pl": "nowa kolekcja",
    "gl": "nova colecci√ìn",
    "eu": "bilduma berria",
    "ca": "nova col.lecci√ì",
    "nl": "nieuwe collectie",
    "zh": "Êñ∞ÂìÅ",
    "ro": "noua colec?ie",
    "ru": "–ù–û–í–ê–Ø –ö–û–õ–õ–ï–ö–¶–ò–Ø",
    "se": "ny kollektion"
  }
};

</script>


<script type="text/javascript">

inditex.onready(function(){

    lfmenuhighlightsjson = 
  {
      "imgversion":"?ver=20180129",
      "imgprefix":"/images/menuhighlights/comun2016/",
      "needbanners":true,
      "items":
      [
        //woman
        {
          "id":"1029506",
          "block": "0",
          "text":"",
          "images":
          [
            // {
            //   "url":"20180129/woman1.jpg",
            //   "link":""
            // },
            {
              "url":"20180129/woman.jpg",
              "link":""
            }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //man
        {
          "id":"1032538",
          "block": "0",
          "text":"",
          "images":
          [
            {
              "url":"20180129/man.jpg",
              "link":""
            },
            // {
            //   "url":"20180129/man2.jpg",
            //   "link":""
            // }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //girls
        {
          "id":"1032539",
          "block": "0",
          "text":"",
          "images":
          [
            // {
            //   "url":"20180129/girl1.jpg",
            //   "link":""
            // },
            {
              "url":"20180129/girl.jpg",
              "link":""
            }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //boys
        {
          "id":"1032540",
          "block": "0",
          "text":"",
          "images":
          [
            {
              "url":"20180129/boy.jpg",
              "link":""
            },
            // {
            //   "url":"20180129/boy2.jpg",
            //   "link":""
            // }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },        


        //kids
        {
          "id":"1094513",
          "block": "0",
          "text":"",
          "images":
          [
            {
              "url":"20170727/kids-boy.jpg",
              "link":""
            },
            {
              "url":"20170727/kids-girl.jpg",
              "link":""
            }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //denim
        {
          "id":"1032545",
          "block": "0",
          "text":"",
          "images":
          [
            {
              "url":"20170727/man-denim.jpg",
              "link":""
            },
            {
              "url":"20170727/woman-denim.jpg",
              "link":""
            }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //sport
        {
          "id":"1032537",
          "block": "0",
          "text":"",
          "images":
          [
           {
              "url":"20170727/sportwear1.jpg",
              "link":""
            },
           {
              "url":"20170727/sportwear.jpg",
              "link":""
            }              
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //shoes
        {
          "id":"1032544",
          "block": "0",
          "text":"",
          "images":
          [
            {
              "url":"20170727/man-calzado.jpg",
              "link":""
            },
            {
              "url":"20170727/woman-calzado.jpg",
              "link":""
            }             
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //editorials
        {
          "id":"1135007",
          "block": "0",
          "text":"",
          "images":
           [
            {
              "url":"20180129/editorials.jpg",
              "link":""
            } 
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        }
      ]
    };

  },true);


</script>





<link href="https://fonts.googleapis.com/css?family=inknut+antiqua:300,400|judson" rel="stylesheet">
<script type="text/javascript">var lfassetsversioning = "?ver=20180212";</script>

<link rel="shortcut icon" type="image/x-icon" href="https://static.lefties.com/9/static/images/favicon.ico?20161201" />
<!-- lf2 responsive metatag -->
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<!-- end lf2 responsive metatag --><!-- lf2_sidemenu_scroller_colors -->
<!-- colores de la flecha en el scroller del men√∫ lateral -->
<script>
var lfmenuscroller = {
	'ovalcolor' : 000,
  	'arrowcolor' : "fff"    
}
</script><script type="text/javascript">



  var lflanguages = 
  {
    "strings": {
      "enter": "enter",
      "country": "country",
      "language": "language",
      "search": "search",
      "login": "log in",
      "wishlist": "wish list",
      "shoppingbag": "shopping bag",
      "type": "type",
      "color": "colour",
      "size": "size",
      "price": "price",
      "products": "products",
      "back": "back",
      "facebook": "facebook",
      "pinterest": "pinterest",
      "twitter": "twitter",
      "email": "e-mail",
      "sizeguide": "size guide",
      "addtobag": "add to shopping basket",
      "addtowishlist": "add to wish list",
      "viewshopping": "see shopping basket",
      "stockstores": "in-store stock",
      "compositionandcare": "composition and care instructions",
      "composition": "composition",
      "care": "care",
      "completeyourlook": "complete your look",
      "lastviewedproducts": "recently viewed products",
      "filtro": "filtro",
      "send": "send",
      "woman": "woman",
      "man": "man",
      "kids": "children",
      "accept": "accept",
      "code": "code:",
      "noproducts": "no results were found for your search criteria.<br/>please try again.",
      "stockpopuptitle": "check in-store stock and reserve",
      "stockpopupdescription": "enter your post code or city to see if the item is available. the availability displayed may not be accurate due to high turnover of our items. we recommend you confirm by calling the store directly.",
      "stockpopupcpcityhint": "pc / city",
      "stockpopupsizehint": "size",
      "stockpopupsearchbutton": "search for stores",
      "stockpopupwait": "please wait a moment. we are checking the availability of the item. it may take a few seconds. thank you.",
      "stockpopupbookbutton": "reserve",
      "stockpopupavalablesizes": "available sizes:",
      "stockpopupformtitle": "reserve in store",
      "stockpopupformsubtitle": "once you have filled in the following form you will receive an e-mail and an sms as soon as possible indicating whether the reservation was possible due to stock availability. you will have up to 48 hours to pick up the garment in your chosen store.",
      "stockpopupformstatussearching": "please wait a moment. we are checking the availability of the item. it may take a few seconds. thank you.",
      "stockpopupformstatusnoresults": "there are no stores in the selected area that have this product in stock. please try a different search.",
      "formname": "name",
      "formsurname": "surname(s)",
      "formemail": "e-mail",
      "formemailconfirm": "confirm e-mail",
      "formemailbirth": "date of birth",
      "formphone1": "phone number",
      "formphone2": "confirm phone number",
      "formcity": "city",
      "formprovince": "province",
      "formcountry": "country",
      "formtienda": "store",
      "formcomment": "comments",
      "formmessage": "message",
      "formissue": "subject",
      "formsubject": "subject",
      "formcaptchhint": "write the text in the image below here",
      "formprivacypolicy1": "i accept the",
      "formprivacypolicy2": "privacy policy",
      "requiredfields": "* required fields",
      "stockpopupprivacypolicy": "i accept the privacy policy for the in-store reservation service.",
      "stockpopupbooksuccess": "we have processed your reservation correctly,<br/>you will receive status updates by e-mail and sms",
      "emailpopuptitle": "share with a friend",
      "emailpopupyourname": "your name",
      "emailpopupyouremail": "your e-mail",
      "emailpopupfriendsname": "your friend's name",
      "emailpopupfriendsemail": "your friend's e-mail",
      "emailpopupsent": "your e-mail has been sent correctly",
      "newslettersubscribe": "subscribe",
      "newsletterunsubscribe": "unsubscribe",
      "newslettersubscribetitle": "subscribe to our newsletter",
      "newslettersubscribedescription": "subscribe to our newsletter and we will send you regular information about new items and trends.",
      "newslettersubscribechoosesections": "select your areas of interest *",
      "newslettersubscribewoman": "woman",
      "newslettersubscribeman": "man",
      "newslettersubscribegirl": "girl",
      "newslettersubscribeboy": "boy",
      "newslettersubscribebaby": "baby",
      "newsletterunsubscribetitle": "do you want to stop receiving our newsletter?",
      "newsletterunsubscribedescription": "enter the e-mail you used to subscribe and click on unsubscribe",
      "newslettersubscribeconfirmmail": "we have sent you an e-mail to confirm your subscription to our newsletter. check your e-mail and follow the steps to complete your subscription. thank you.",
      "newsletterunsubscribeconfirmmail": "we have sent you an e-mail to confirm your unsubscription from our newsletter. check your e-mail and follow the steps to complete your unsubscription. thank you.",
      "newslettersubscribeconfirmpagedescription": "your newsletter subscription request has been processed correctly.",
      "contactdescription": "we will answer all your questions about lefties here.",
      "usecookiestext": "we use first and third-party cookies to improve your experience and our service, analysing how users browse our website. if you continue on this website we shall assume that you accept their use. you can get more information or find out how to change your settings by reading our <a id=\"cookiespolicy\">cookies policy</a>.",
      "storelocatortitlelink": "stores",
      "storelocatorviewonmap": "see on map",
      "storelocatormapview": "see on map",
      "storelocatorlistview": "see in a list",
      "generalerror": "an error has occurred with your request. please try again later.",
      "policiesconditions": "terms of use",
      "policiesprivacy": "privacy policy",
      "policiescookies": "cookies policy",
      
      
      "error404": "error 404. the page you are looking for does not exist.",
      "errorpage": "we are sorry but the page you are looking for is not available at this time. please try again later.",
      "gohomebutton": "go to the home page",
      "homenewslettermoduletitle": "subscribe now!",
      "homenewslettermoduledescription": "receive our latest news",
      "homecontactmoduletitle": "customer service",
      "homecontactmoduledescription": "send us your questions",
      "homecontactsocialpretitle": "follow us",
      "homecontactsocialdescription": "find out more about our world",
      
      "companytitle": "company",
      "newslettertitle": "newsletter",
      "contacttitle": "contact",
      "policiestitle":"policies",
      "storestitle":"stores",
      
      "prod_outside":"exterior",
      "prod_lining":"lining",
      "prod_inside":"interior",
      "prod_cut":"cut",
      "prod_sole":"sole",
      "storelocator_noresults":"no stores found for your search",
      "storelocatorenteralocation":"enter a location",
      
      "inputdataerror":"you must fill in all required fields and accept the privacy policy.",
      "inputdataerrornoprivacy":"you must fill in all required fields.",
      "noproductsnosearch":"there are no products in this category.",
      "subscriptiongeneric":"you request has been processed correctly.",
      "formbirtherror":"this date of birth does not have the correct format: dd/mm/yyyy.",
      "formemailerror":"incorrect e-mail format.",
      "sharetoafriendlegaldisclaimer":"*if you provide us with personal data to share a our product with a friend, such information shall be used only for the purposes of sending this communication and itx fashion will not store any personal data. please take into account that it is your responsibility to advise the recipient (your friend) regarding the disclosure and use of such information and obtain his/her consent to the disclosure, if necessary.",
      
      "morecolors":"+ colours",
      "uniquesize":"one size fits all",
      
      "formphonenotequal":"the \"confirm phone number\" field must match the \"phone number\" field",
            
      "ticketnumber":"receipt no.",
      "legalbases":"legal terms and conditions",
      
      "stockandbookstores":"stock and reservations in shops",
      "stockandbookstoresdisabled":"in-store stock reserve is disabled for sale items.",
      
      "yyyy":"yyyy",
      "mm":"mm",
      "dd":"dd",
      "newslettersubscribetitlepopup":"subscribe to our newsletter<br/>and get the latest news",
      "newslettersubscribebuttonpopup":"subscribe",
      "sex":"sex",
      "close":"close",
      
      "popupstocktitle":"reserve at www.lefties.com<br/>in three easy steps",
      "popupstocknum1":"one",
      "popupstocknum2":"two",
      "popupstocknum3":"three",
      "popupstockdesc1":"find your favourite product at www.lefties.com",
      "popupstockdesc2":"click the \"stock and reservations in shops\" button and enter your information",
      "popupstockdesc3":"receive the confirmation e-mail and pick up your order at the store",


      "notainformativatitle":"nota informativa",
      "notainformativasubtitle":"devoluci√≥n sandalias ni√±a",
      "notainformativatext":"en lefties nos esforzamos en garantizar la m√°s alta calidad de nuestros productos.en consecuencia nos gustar√≠a informar a nuestros clientes de la identificaci√≥n de un leve defecto de calidad en la fabricaci√≥n del art√≠culo con referencia 4716/293/105 y 4717/293/105. si ud. ha adquirido una de estas sandalias, para poder realizar la devoluci√≥n del art√≠culo, dir√≠jase a la tienda m√°s cercana, contacte con nosotros en caja y una de nuestras cajeras proceder√° al rembolso completo del producto. les pedimos disculpas por cualquier inconveniente que se pueda ocasionar.",
      "notainformativalink":"www.lefties.com",


    }
  };
</script>
<script type="text/javascript">
  var menucustomcolors =
  {
    "1174001":
    {
      "color":"#fb0062"
    },
    "1174501":
    {
      "color":"#fb0062"
    },
    "1174502":
    {
      "color":"#fb0062"
    },
    "1174503":
    {
      "color":"#fb0062"
    },
    "1170502":
    {
      "color":"#fb0062"
    },
    "1170501":
    {
      "color":"#fb0062"
    },
    "1170503":
    {
      "color":"#fb0062"
    },
    "1170504":
    {
      "color":"#fb0062"
    },
    "1224507":
    {
      "color":"#8f28ce"
    },
    "1245511":
    {
      "color":"#e6c480"
    },
    "1245515":
    {
      "color":"#e6c480"
    },
    "1245509":
    {
      "color":"#e6c480"
    },
    "1245508":
    {
      "color":"#e6c480"
    },
    "1245501":
    {
      "color":"#e6c480"
    },
    "1247501":
    {
      "color":"#fb0062"
    },
    "1258006":
    {
      "color":"#fb0062"
    },
    "1258012":
    {
      "color":"#fb0062"
    },
    "1261019":
    {
      "color":"#fb0062"
    },
    "1261020":
    {
      "color":"#fb0062"
    },
    "1261021":
    {
      "color":"#fb0062"
    },
    "1350504":
    {
      "color":"#fb0062"
    },
    "1350503":
    {
      "color":"#fb0062"
    },
    "1351504":
    {
      "color":"#fb0062"
    },
    "1351503":
    {
      "color":"#fb0062"
    },
    "1329006":
    {
      "color":"#fb0062"
    },
    "1329007":
    {
      "color":"#fb0062"
    },
    "1181513":
    {
      "color":"#ff5f90"
    },
    "1181511":
    {
      "color":"#ff5f90"
    },
    /*"1330505":
    {
      "color":"#00c6db"
    },
    "1320506":
    {
      "color":"#00c6db"
    },
    "1338017":
    {
      "color":"#00c6db"
    },
    "1335013":
    {
      "color":"#00c6db"
    },
    "1342523":
    {
      "color":"#00c6db"
    },
    "1325501":
    {
      "color":"#00c6db"
    },
    "1342524":
    {
      "color":"#00c6db"
    },
    "1342525":
    {
      "color":"#00c6db"
    },*/
    "1334506":
    {
      "color":"#fb0062"
    },
    "1334507":
    {
      "color":"#fb0062"
    },
    "1334508":
    {
      "color":"#fb0062"
    },
    "1338501":
    {
      "color":"#fb0062"
    },
    "1338502":
    {
      "color":"#fb0062"
    },
    
    "1351501":
    {
      "color":"#fb0062"
    },
    "1351502":
    {
      "color":"#fb0062"
    },
    "1357515":
    {
      "color":"#fb0062"
    },
    
    /*
    "1194511":
    {
      "color":"#000",
      "font-weight":"bold"
    },
    */
    
    "1329004":
    {
      "color":"#fb0062"
    },
    "1329005":
    {
      "color":"#fb0062"
    },
    "1329007":
    {
      "color":"#fb0062"
    },
    "1329006":
    {
      "color":"#fb0062"
    }
    
    
    /*,
    "1032539":
    {
      "color":"#fb0062"
    },
    "1032540":
    {
      "color":"#fb0062"
    },
    "1041590":
    {
      "color":"#fb0062"
    },
    "1032541":
    {
      "color":"#fb0062"
    }*/
    
  };
</script>
<script type="text/javascript">

  inditex.onready(function(){

    lfbottommenujson =
    [
      {
        "name":"companytitle",
        "url":"https://www.lefties.com/sa/util/company-c1119511.html"
      },
      {
        "name":"contacttitle",
        "url":"https://www.lefties.com/sa/util/contact-c1103511.html"
      },
      {
        "name":"storestitle",
        "url":"https://www.lefties.com/sa/store-locator.html"
      },
      {
        "name":"policiestitle",
        "url":"https://www.lefties.com/sa/util/policies-c1120001.html"
      },
      {
        "name":"newslettertitle",
        "url":"https://www.lefties.com/sa/util/newsletter-c1099002.html"
      },
      {
        "name":"¬© lefties",
        "url":""
      }
    ];
  },true);



salesconfiguratorjson=
{
  "doublemenu":
  {
    "1029506":{},
    "1032536":{},
    "1032538":{},
    "1094513":{},
    "1032545":{},
    "1032537":{},
    "1032544":{}
  },
  // "activatesales": ["ru","pt","mx", "es"],
  "activatesales": [],
  "xsalespriority": true,
  "onlyncaftersales": [],
  "desactivaenviotienda": [],
  "salespriority": ["ru","pt","mx","es"],
  "activamensajenoenviotienda": [],
  "activamensajeplazoentrega": [],
  "muestraplazoenmenu": [],
  "hidesales": [],
  "activatepresales": [],
  "activatesaleskids": false,
  "salescategoriesidexcl":
  [
    "1041621","1029507","1041677","1344508","1041668","1041630","1041629","1041623","1041598","1506008","1038181","1029529","1032508","1029514","1029511","1194511","1344506", "1204502", "1041666", "1506007", "1506004", "1245511","1029507","1344506","1044501","1202022","1245509","1038056","1204506","1506006","1245508","1038177","1207013","1207014","1245501","1133023","1207015","1251512","1010046502","1041555","1134031","1135011","1041667","1041675","1335501","1135008","1135505","1135506","1038178","1038066","1172001"
  ],
  "nccategoriesidexcl":
  [
      "1342523","1166001","1038186","1041621","1041630","1204507","1506006","1038064","1038063","1032512","1032508","1029508","1330505","1032513","1335013","1038172","1506007","1038188","1506008","1041506","1342525","1041629","1041666","1041670","1344508","1041677","1342524","1041675","1032556","1506004","1319502","1032527","1319503","1330527","1044507","1041598","1041624","1041667","1041674","1202522","132572","1032578","1202022","1204506","1245509","1245511","1245508","1207013","1207014","1245501","1207015","1251512"
  ]
};

var salestextsjson =
{
  "msgsales":
  {
    "es": "rebajas",
    "en": "sale",
    "it": "saldi",
    "pt": "saldos",
    "fr": "soldes",
    "de": "schlussverkauf",
    "pl": "wyprzedaz",
    "gl": "rebaixas",
    "eu": "beherapenak",
    "ca": "rebaixes",
    "nl": "uitverkoop",
    "zh": "ÊäòÊâ£",
    "ro": "reduceri",
    "ru": "–°–ö–ò–î–ö–ò",
    "se": "rea"
  },
  "msgnc":
  {
    "es": "nueva colecci√ìn",
    "en": "new collection",
    "it": "nuova collezione",
    "pt": "nova cole√á√Éo",
    "fr": "nouvelle collection",
    "de": "neue kollektion",
    "pl": "nowa kolekcja",
    "gl": "nova colecci√ìn",
    "eu": "bilduma berria",
    "ca": "nova col.lecci√ì",
    "nl": "nieuwe collectie",
    "zh": "Êñ∞ÂìÅ",
    "ro": "noua colec?ie",
    "ru": "–ù–û–í–ê–Ø –ö–û–õ–õ–ï–ö–¶–ò–Ø",
    "se": "ny kollektion"
  }
};

</script>


<script type="text/javascript">

inditex.onready(function(){

    lfmenuhighlightsjson = 
  {
      "imgversion":"?ver=20180129",
      "imgprefix":"/images/menuhighlights/comun2016/",
      "needbanners":true,
      "items":
      [
        //woman
        {
          "id":"1029506",
          "block": "0",
          "text":"",
          "images":
          [
            // {
            //   "url":"20180129/woman1.jpg",
            //   "link":""
            // },
            {
              "url":"20180129/woman.jpg",
              "link":""
            }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //man
        {
          "id":"1032538",
          "block": "0",
          "text":"",
          "images":
          [
            {
              "url":"20180129/man.jpg",
              "link":""
            },
            // {
            //   "url":"20180129/man2.jpg",
            //   "link":""
            // }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //girls
        {
          "id":"1032539",
          "block": "0",
          "text":"",
          "images":
          [
            // {
            //   "url":"20180129/girl1.jpg",
            //   "link":""
            // },
            {
              "url":"20180129/girl.jpg",
              "link":""
            }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //boys
        {
          "id":"1032540",
          "block": "0",
          "text":"",
          "images":
          [
            {
              "url":"20180129/boy.jpg",
              "link":""
            },
            // {
            //   "url":"20180129/boy2.jpg",
            //   "link":""
            // }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },        


        //kids
        {
          "id":"1094513",
          "block": "0",
          "text":"",
          "images":
          [
            {
              "url":"20170727/kids-boy.jpg",
              "link":""
            },
            {
              "url":"20170727/kids-girl.jpg",
              "link":""
            }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //denim
        {
          "id":"1032545",
          "block": "0",
          "text":"",
          "images":
          [
            {
              "url":"20170727/man-denim.jpg",
              "link":""
            },
            {
              "url":"20170727/woman-denim.jpg",
              "link":""
            }
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //sport
        {
          "id":"1032537",
          "block": "0",
          "text":"",
          "images":
          [
           {
              "url":"20170727/sportwear1.jpg",
              "link":""
            },
           {
              "url":"20170727/sportwear.jpg",
              "link":""
            }              
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //shoes
        {
          "id":"1032544",
          "block": "0",
          "text":"",
          "images":
          [
            {
              "url":"20170727/man-calzado.jpg",
              "link":""
            },
            {
              "url":"20170727/woman-calzado.jpg",
              "link":""
            }             
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        },
        //editorials
        {
          "id":"1135007",
          "block": "0",
          "text":"",
          "images":
           [
            {
              "url":"20180129/editorials.jpg",
              "link":""
            } 
          ],
          "paisesin":["qa","sa","ru","pt","mx","es"],
          // "paisesout":["es"],
          "languages":false,
          "link":""
        }
      ]
    };

  },true);


</script>




<link href="https://fonts.googleapis.com/css?family=inknut+antiqua:300,400|judson" rel="stylesheet">
<script type="text/javascript">var lfassetsversioning = "?ver=20180212";</script>

<link rel="shortcut icon" type="image/x-icon" href="https://static.lefties.com/9/static/images/favicon.ico?20161201" />
<!-- end spot=lf2_espot_commoncontent -->
		


<!-- begin spot=lf2_espot_jstlenvironment -->

<!-- end spot=lf2_espot_jstlenvironment -->
<script type="text/javascript">
	window.inditex = window.inditex;
	
	//delete (change www.lefties.com -> www.lefties.local)
        var baseurl = inditex.encodeurl({
            'action' : 'itxhomepage',
            'params' : {
                'storeid' : inditex.istoreid,
                'langid' : inditex.ilangid,
                'catalogid' : inditex.icatalogid
            }
        });
	
</script>
			
			<script type="text/javascript">
				inditex.onready(function() {
					inditex.xrestgetproductdetail(inditex.iproductid, inditex.icategoryid).done(function(product) {
						inditex.ixproductjson = product;
						new itxproductpageclass();
					});
				});
			</script>
			
<!-- begin spot=lf2_espot_productcontent -->
<link rel="stylesheet" type="text/css" media="all" href="https://static.lefties.com/9/static/css/itxproductpage.css?ver=20180319035500" />
<!-- end spot=lf2_espot_productcontent -->
		
<!-- end page head -->

<!-- begin post-common head -->
<script type="text/javascript" src="https://static.lefties.com/9/static/itxwebstandard/js/itx-custom-api.min.js?t=201803190355001913109886"></script>

<!-- begin spot=lf2_espot_inditex -->
<!-- fix_lefties-197 -->
<!-- end spot=lf2_espot_inditex -->

<!-- begin mpulse -->
<script type="text/javascript">
if ((window.inditex && window.inditex.ipage == "itxorderconfirmationpage") || window.isiframe){
	window.boomr_config = { autorun: false };
}
(function() {
    if (window.boomr && window.boomr.version) {
        return;
    }
    var dom, doc, where, iframe = document.createelement("iframe"),
        win = window;

    function boomerangsaveloadtime(e) {
        win.boomr_onload = (e && e.timestamp) || new date().gettime();
    }
    if (win.addeventlistener) {
        win.addeventlistener("load", boomerangsaveloadtime, false);
    } else if (win.attachevent) {
        win.attachevent("onload", boomerangsaveloadtime);
    }

    iframe.src = "javascript:void(0)";
    iframe.title = "";
    iframe.role = "presentation";
    (iframe.frameelement || iframe).style.csstext = "width:0;height:0;border:0;display:none;";
    where = document.getelementsbytagname("script")[0];
    where.parentnode.insertbefore(iframe, where);

    try {
        doc = iframe.contentwindow.document;
    } catch (e) {
        dom = document.domain;
        iframe.src = "javascript:var d=document.open();d.domain='" + dom + "';void(0);";
        doc = iframe.contentwindow.document;
    }
    doc.open()._l = function() {
        var js = this.createelement("script");
        if (dom) {
            this.domain = dom;
        }
        js.id = "boomr-if-as";
        js.src = "//c.go-mpulse.net/boomerang/" +
             "c73q5-ksh3p-ekqgq-p3bjz-3kbk5";
        boomr_lstart = new date().gettime();
        this.body.appendchild(js);
    };
    doc.write('<body onload="document._l();">');
    doc.close();
})();
</script>
<!-- end mpulse -->
<!-- begin spot=lf2_espot_headend -->
<script>
(function(){
  if (window.boomr && window.boomr.version) { return; }
  var dom,doc,where,iframe = document.createelement("iframe"),win = window;

  function boomerangsaveloadtime(e) {
    win.boomr_onload=(e && e.timestamp) || new date().gettime();
  }
  if (win.addeventlistener) {
    win.addeventlistener("load", boomerangsaveloadtime, false);
  } else if (win.attachevent) {
    win.attachevent("onload", boomerangsaveloadtime);
  }

  iframe.src = "javascript:void(0)";
  iframe.title = ""; iframe.role = "presentation";
  (iframe.frameelement || iframe).style.csstext = "width:0;height:0;border:0;display:none;";
  where = document.getelementsbytagname("script")[0];
  where.parentnode.insertbefore(iframe, where);

  try {
    doc = iframe.contentwindow.document;
  } catch(e) {
    dom = document.domain;
    iframe.src="javascript:var d=document.open();d.domain='"+dom+"';void(0);";
    doc = iframe.contentwindow.document;
  }
  doc.open()._l = function() {
    var js = this.createelement("script");
    if (dom) { this.domain = dom; }
    js.id = "boomr-if-as";
    js.src = "//c.go-mpulse.net/boomerang/" +
    "c73q5-ksh3p-ekqgq-p3bjz-3kbk5";
    boomr_lstart=new date().gettime();
    this.body.appendchild(js);
  };
  doc.write('<body onload="document._l();">');
  doc.close();
})();
</script>
<!-- end spot=lf2_espot_headend -->

<!-- end post-common head -->
	</head>
	<body>
<!-- begin spot=lf2_espot_bodybegin -->

<!-- end spot=lf2_espot_bodybegin -->

<script type="application/ld+json">
{
  "@context": "http://schema.org/",
  "@type": "product",
  "logo" : "https://static.lefties.com/9/static/itxwebstandard/logo/logo.png?t=201803190355001913109886",
  "name": "pompom ballerinas",
  "image": "https://static.lefties.com/9/photos//2018/v/1/3/p/4415/393/020/4415393020_1_1_3.jpg?t=ts",
  "description": "pompom ballerinas",
  "mpn": "4414/393",
  "brand": "lefties",
  "offers": {
    "@type": "offer",
    "pricecurrency": "sar",
    "price": "55",
    "url": "https://www.lefties.com/sa/girls/shoes/pompom-ballerinas-c1094517p500629982.html?keywordcatentry=pompom+ballerinas",
	"category": "girls - shoes",
	"eligibleregion" : "sa"
  }
}
</script>	
<!-- begin spot=lf2_espot_bodyend -->

<!-- end spot=lf2_espot_bodyend -->

<script type="text/javascript">
	(function(){
		var re = new regexp("^(http|https)://" + location.host + "$");
		var pattern_var = new regexp("\\{[*a-za-z]+\\}");
		var appid = 1;
		var restmap = {
			"akamai:location": ["get", "/user-location-detection"],
			"bam:physicalstores1": ["get", "/itxrest/2/bam/store/{storeid}/physical-store"],
			"bam:physicalstores2": ["get", "/itxrest/2/bam/store/{storeid}/physical-stores"],
			"bam:storesbycity": ["get", "/itxrest/2/bam/store/{storeid}/physical-stores-by-city"],
			"bam:physicalstore": ["get", "/itxrest/2/bam/store/{storeid}/physical-store/{physicalstoreid}"],
			"bam:physicalstoresbycountry": ["get", "/itxrest/2/bam/store/{storeid}/physical-stores-by-country"],
			"bam:physicalstoresbystate": ["get", "/itxrest/2/bam/store/{storeid}/physical-stores-by-state"],
			"bam:states": ["get", "/itxrest/2/bam/store/{storeid}/state"],
			"bam:country": ["get", "/itxrest/2/bam/store/{storeid}/country"],
			"bam:addfavouritestore": ["post", "/itxrest/2/bam/store/{storeid}/favourite-store"],
			"bam:deletefavouritestore": ["delete", "/itxrest/2/bam/store/{storeid}/favourite-store/{favouritestoreid}"],
			"bam:bamstock": ["get", "/itxrest/2/bam/store/{storeid}/bam-stock"],
			"bam:droppoint": ["get", "/itxrest/2/bam/store/{storeid}/drop-point"],
			"bam:droppointlists": ["get", "/itxrest/2/bam/store/{storeid}/drop-point-lists"],
			"bam:packstation": ["get", "/itxrest/2/bam/store/{storeid}/packstation"],
			"bam:droppointstate": ["get", "/itxrest/2/bam/store/{storeid}/itx-drop-point/state"],
			"bam:droppointmunicipality": ["get", "/itxrest/2/bam/store/{storeid}/itx-drop-point/municipality"],
			"bam:droppointcolony": ["get", "/itxrest/2/bam/store/{storeid}/itx-drop-point/colony"],
			"bam:droppointitx": ["get", "/itxrest/2/bam/store/{storeid}/itx-drop-point"],
			"bam:districts": ["get", "/itxrest/2/bam/store/{storeid}/districts"],
			"bam:cities": ["get", "/itxrest/2/bam/store/{storeid}/cities"],
			"bam:citiesphysicalstore": ["get", "/itxrest/2/bam/store/{storeid}/cities-physical-store"],
			"booking:addbooking": ["post", "/itxrest/2/booking/store/{storeid}"],
			"booking:getbookingsbyuser": ["get", "/itxrest/2/booking/store/{storeid}"],
			"booking:getbookingbyid": ["get", "/itxrest/2/booking/store/{storeid}/{bookingid}"],
			"booking:deletebookingbyid": ["delete", "/itxrest/2/booking/store/{storeid}/{bookingid}"],
			"catalog:stores": ["get", "/itxrest/2/catalog/store"],
			"catalog:store": ["get", "/itxrest/2/catalog/store/{storeid}"],
			"catalog:categories": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/category"],
			"catalog:category": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/category/{categoryid}"],
			"catalog:products": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/category/{categoryid}/product"],
			"catalog:productsbycategorykey": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/categorykey/{categorykey}/product"],
			"catalog:productsbysearchterm": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/product"],
			"catalog:productdetail": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/category/{categoryid}/product/{productid}/detail"],
			"catalog:productsbypartnumber": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/product/{partnumber}"],
			"catalog:productsbyshorturl": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/shorturl/{shorturl}"],
			"catalog:bundlecolors": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/product/{partnumber}/bundlecolors"],
			"catalog:productstock": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/product/{productid}/stock"],
			"catalog:productsstock": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/product/stock"],
			"catalog:categorystock": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/category/{categoryid}/stock"],
			"catalog:returnreason": ["get", "/itxrest/2/catalog/store/{storeid}/return-reason"],
			"catalog:sendtoafriend": ["post", "/itxrest/2/catalog/store/{storeid}/{catalogid}/category/{categoryid}/product/{productid}/sendtoafriend"],
			"catalog:stocknotification": ["post", "/itxrest/2/catalog/store/{storeid}/{catalogid}/category/{categoryid}/product/{productid}/stocknotification"],
			"catalog:getproductstock": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/product/stock"],
			"catalog:colbenson": ["get", "/itxrest/2/catalog/store/{storeid}/{catalogid}/colbenson"],
			"giftcard:physicalgiftcard": ["get", "/itxrest/2/giftcard/store/{storeid}/{catalogid}/physicalgiftcard"],
			"giftcard:virtualgiftcard": ["get", "/itxrest/2/giftcard/store/{storeid}/{catalogid}/virtualgiftcard"],
			"giftcard:addphysicalgiftcardtoshopcart": ["post", "/itxrest/2/giftcard/store/{storeid}/cart/physicalgiftcard"],
			"giftcard:addvirtualgiftcardtoshopcart": ["post", "/itxrest/2/giftcard/store/{storeid}/cart/virtualgiftcard"],
			"giftcard:physicalgiftcarddata": ["get", "/itxrest/2/giftcard/store/{storeid}/physicalgiftcard/{orderitemid}/data"],
			"giftcard:virtualgiftcarddata": ["get", "/itxrest/2/giftcard/store/{storeid}/virtualgiftcard/{orderitemid}/data"],
			"giftcard:updatephysicalgiftcarddata": ["post", "/itxrest/2/giftcard/store/{storeid}/physicalgiftcard/{orderitemid}"],
			"giftcard:updatevirtualgiftcarddata": ["post", "/itxrest/2/giftcard/store/{storeid}/virtualgiftcard/{orderitemid}"],
			"giftcard:giftcardbalance": ["put", "/itxrest/2/giftcard/store/{storeid}/balance"],
			"giftcard:activategiftcard": ["put", "/itxrest/2/giftcard/store/{storeid}/activate"],
			"marketing:marketingspots": ["get", "/itxrest/2/marketing/store/{storeid}/{catalogid}/spot"],
			"oam:crash": ["post", "/itxrest/2/oam/crash"],
			"oam:xconfiguracion": ["get", "/itxrest/2/oam/store/{storeid}/xconfiguracion"],
			"oam:launch": ["post", "/itxrest/2/oam/store/{storeid}/launch"],
			"oam:validation": ["get", "/itxrest/2/oam/store/{storeid}/validation"],
			"oam:pushtoken": ["put", "/itxrest/2/oam/store/{storeid}/push-token"],
			"order:addtocart": ["post", "/itxrest/2/order/store/{storeid}/cart"],
			"order:updatecart": ["put", "/itxrest/2/order/store/{storeid}/cart"],
			"order:deletefromcart": ["delete", "/itxrest/2/order/store/{storeid}/cart/{sku}"],
			"order:minicart": ["get", "/itxrest/2/order/store/{storeid}/minicart"],
			"order:shoppingcart": ["get", "/itxrest/2/order/store/{storeid}/cart", true],
			"order:shippingunique": ["get", "/itxrest/2/order/store/{storeid}/shipping/unique"],
			"order:shippingmethods1": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/shipping"],
			"order:shippingmethods2": ["get", "/itxrest/2/order/store/{storeid}/{catalogid}/shipping"],
			"order:shippingmethods3": ["get", "/itxrest/2/order/store/{storeid}/{catalogid}/shipping/default"],
			"order:paymentmethods": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/payment"],
			"order:getidealbanks": ["get", "/itxrest/2/order/store/{storeid}/ideal-banks"],
			"order:paymentmodes": ["put", "/itxrest/2/order/store/{storeid}/order/{orderid}/payment/{policy}/mode"],
			"order:checkoutshipping": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/checkout/shipping"],
			"order:postpunchout": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/punchout/{acquirer}/policy/{policyname}"],
			"order:getpunchout": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/punchout/{acquirer}/policy/{policyname}"],
			"order:cancel": ["delete", "/itxrest/2/order/store/{storeid}/order/{orderid}"],
			"order:cancelguest": ["delete", "/itxrest/2/order/store/{storeid}/order-guest/{orderid}"],
			"order:orders": ["get", "/itxrest/2/order/store/{storeid}/order"],
			"order:order": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}"],
			"order:orderguest": ["get", "/itxrest/2/order/store/{storeid}/order-guest/{orderid}"],
			"order:orderconfirmation": ["get", "/itxrest/2/order/store/{storeid}/{catalogid}/order/{orderid}"],
			"order:ordersummary": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/summary"],
			"order:addpromocode": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/promocode"],
			"order:deletepromocode": ["delete", "/itxrest/2/order/store/{storeid}/order/{orderid}/promocode/{promocode}"],
			"order:addgiftpacking": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/giftpacking"],
			"order:deletegiftpacking": ["delete", "/itxrest/2/order/store/{storeid}/order/{orderid}/giftpacking"],
			"order:returnrequest": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/return-request"],
			"order:returnrequestguest": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/return-request-guest"],
			"order:rmalist": ["get", "/itxrest/2/order/store/{storeid}/rma-list"],
			"order:getgiftticket": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/giftticket"],
			"order:rma": ["get", "/itxrest/2/order/store/{storeid}/rma/{rmaid}"],
			"order:cardsadjustments": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/checkout/card-adjustments"],
			"order:deletecardsadjustments": ["put", "/itxrest/2/order/store/{storeid}/order/{orderid}/checkout/card-adjustments"],
			"order:asynccheckout": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/asynccheckout"],
			"order:asyncrepay": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/asyncrepay"],
			"order:asyncrepayguest": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/asyncrepay-guest"],
			"order:paymentstatus": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/payment-status"],
			"order:generateinvoice": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/invoice/{invoiceid}"],
			"order:generateinvoicemobile": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/invoicemobile/{invoiceid}"],
			"order:getorderidfrombarcode": ["get", "/itxrest/2/order/store/{storeid}/barcode/{barcode}/captcha/{captcha}"],
			"order:klarnaaccountstaticoptobj": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/klarna"],
			"order:paymentselected": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/paymentselected"],
			"order:shippingdate": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/shippingdate"],
			"order:shippingrange": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/shippingrange"],
			"order:manualtransfer": ["post", "/itxrest/2/order/store/{storeid}/rma/{rmaid}/manualtransfer"],
			"order:unboundpayment": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/checkout/unboundpayment"],
			"order:ticket": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/ticket"],
			"order:ticket-guest": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/ticket-guest"],
			"order:validatesmscode": ["post", "/itxrest/2/order/store/{storeid}/order/{orderid}/validate"],
			"order:getpkpass": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/pkpass"],
			"order:qrimage": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/qr/image"],
			"order:qrimageguest": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/qr-guest/image"],
			"secure:getcaptcha": ["get", "/itxrest/2/secure/store/{storeid}/captcha/image"],
			"secure:getnativecaptcha": ["get", "/itxrest/2/secure/store/{storeid}/captcha"],
			"user:loginguest": ["post", "/itxrest/2/user/store/{storeid}/guest-identity"],
			"user:login": ["post", "/itxrest/2/user/store/{storeid}/identity"],
			"user:sociallogin": ["post", "/itxrest/2/user/store/{storeid}/social-identity"],
			"user:sociallogout": ["delete", "/itxrest/2/user/store/{storeid}/social-identity"],
			"user:currentuser": ["post", "/itxrest/2/user/store/{storeid}/current-user", true],
			"user:logout": ["delete", "/itxrest/2/user/store/{storeid}/identity"],
			"user:register": ["post", "/itxrest/2/user/store/{storeid}/user"],
			"user:resetpassword": ["put", "/itxrest/2/user/store/{storeid}/password"],
			"user:updateuseremail": ["post", "/itxrest/2/user/store/{storeid}/email"],
			"user:updateuserpassword": ["post", "/itxrest/2/user/store/{storeid}/password"],
			"user:addressbook": ["get", "/itxrest/2/user/store/{storeid}/address"],
			"user:addressinfobyid": ["get", "/itxrest/2/user/store/{storeid}/address/{addressid}"],
			"user:addressinfobyidguest": ["get", "/itxrest/2/user/store/{storeid}/address-guest/{addressid}"],
			"user:addupdateaddress": ["post", "/itxrest/2/user/store/{storeid}/address", true],
			"user:receivenotreceiveinvoice": ["put", "/itxrest/2/user/store/{storeid}/invoice"],
			"user:deleteaddress": ["delete", "/itxrest/2/user/store/{storeid}/address/{addressid}"],
			"user:invoices": ["get", "/itxrest/2/user/store/{storeid}/invoices"],
			"user:invoicesguest": ["get", "/itxrest/2/user/store/{storeid}/invoices-guest"],
			"user:newsletterstatus": ["get", "/itxrest/2/user/store/{storeid}/newsletter"],
			"user:subscribenewsletterrequest": ["post", "/itxrest/2/user/store/{storeid}/newsletter-request"],
			"user:unsubscribenewsletterrequest": ["delete", "/itxrest/2/user/store/{storeid}/newsletter-request"],
			"user:subscribenewsletterconfirmation": ["post", "/itxrest/2/user/store/{storeid}/newsletter-confirmation"],
			"user:unsubscribenewsletterconfirmation": ["delete", "/itxrest/2/user/store/{storeid}/newsletter-confirmation"],
			"user:updateresetuserpassword": ["post", "/itxrest/2/user/store/{storeid}/password-reset"],
			"user:contact": ["post", "/itxrest/2/user/store/{storeid}/contact"],
			"user:receivenotreceiveeinvoice": ["put", "/itxrest/2/user/store/{storeid}/orderid/{orderid}/einvoice"],
			"user:getpoliciesuser": ["post", "/itxrest/2/user/store/{storeid}/policy"],
			"user:useravailabledata": ["get", "/itxrest/2/user/store/{storeid}/availabledata"],
			"user:validatesmscode": ["post", "/itxrest/2/user/store/{storeid}/validate"],
			"user:generatecodeaccessorders": ["post", "/itxrest/2/user/store/{storeid}/generate-code-access-orders"],
			"user:gettokensguestorders": ["post", "/itxrest/2/user/store/{storeid}/get-tokens-guest-orders"],
			"user:getsocial": ["get", "/itxrest/2/user/store/{storeid}/social"],
			"user:savesizes" : ["put", "/itxrestservux/2/store/{storeid}/size"],
			"user:getsizes" : ["get", "/itxrestservux/2/store/{storeid}/size"],
			"user:policiesvalidation" : ["post", "/itxrest/2/user/store/{storeid}/policies-validation"],
			"wallet:makecarddefault": ["put", "/itxrest/2/wallet/store/{storeid}/make-default"],
			"wallet:deletecard": ["delete", "/itxrest/2/wallet/store/{storeid}/card/{hash}"],
			"wallet:orderpreview": ["get", "/itxrest/2/wallet/store/{storeid}/order-preview"],
			"wallet:walletinfo": ["get", "/itxrest/2/wallet/store/{storeid}/order/{orderid}/wallet-info"],
			"wallet:getwalletcards": ["get", "/itxrest/2/wallet/store/{storeid}/cards"],
			"wallet:getwalletcards2": ["post", "/itxrest/2/wallet/store/{storeid}/cards2"],
			"wallet:getwalletcard": ["post", "/itxrest/2/wallet/store/{storeid}/card"],
			"wallet:savewalletdata": ["post", "/itxrest/2/wallet/store/{storeid}/order/{orderid}/save-wallet-data"],
			"wallet:deletewalletdata": ["post", "/itxrest/2/wallet/store/{storeid}/delete-wallet-data"],
			"wallet:paymentwalletqr": ["get", "/itxrest/2/wallet/store/{storeid}/order/{orderid}/qr-payment-token"],
			"wallet:walletqrcards": ["get", "/itxrest/2/wallet/store/{storeid}/order/{orderid}/qr-cards"],
			"wishlist:addtowishlist": ["post", "/itxrest/2/wish/store/{storeid}/wishlist"],
			"wishlist:updatewishlist": ["put", "/itxrest/2/wish/store/{storeid}/wishlist"],
			"wishlist:wishlistbyuser": ["get", "/itxrest/2/wish/store/{storeid}/wishlist"],
			"wishlist:wishlistbyid": ["get", "/itxrest/2/wish/store/{storeid}/wishlist/{wihslistid}/{userid}"],
			"wishlist:addwishlisttoorder": ["post", "/itxrest/2/wish/store/{storeid}/wishlist/addorder"],
			"wishlist:sendwishlistbyemail": ["post", "/itxrest/2/wish/store/{storeid}/wishlist/sendemail"],
			"sfi:banks": ["get", "/itxrest/2/sfi/store/{storeid}/banks"],
			"cb:getcart": ["get", "/itxrestservcart/2/store/{storeid}/order/cart"],
			"cb:safecart": ["put", "/itxrestservcart/2/store/{storeid}/order/cart"],
			"cb:deletecart": ["delete", "/itxrestservcart/2/store/{storeid}/order/cart"],
			"cb:wishlists": ["get", "/itxrestservcart/2/store/{storeid}/wishlist"],
			"cb:savewishlists": ["put", "/itxrestservcart/2/store/{storeid}/wishlist"],
			"support:workgroups": ["get", "/itxrest/2/support/store/{storeid}/chat/workgroups"],
			"support:promotions": ["get", "/itxrest/2/support/store/{storeid}/promotion"],	
			"rma:requests": ["get", "/itxrest/2/order/store/{storeid}/rmareq-list"],
			"rma:requestsguest": ["get", "/itxrest/2/order/store/{storeid}/rmareq-list-guest"],
			"rma:byorderid": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/rma"],
			"rma:byorderidguest": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/rma-guest"],
			"rma:requestinfo": ["get", "/itxrest/2/order/store/{storeid}/rmareq/{rmareqid}"],
			"rma:requestinfoguest": ["get", "/itxrest/2/order/store/{storeid}/rmareq-guest/{rmareqid}"],
			"rma:requestsbyorderid": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/rmareq"],
			"rma:requestsbyorderidguest": ["get", "/itxrest/2/order/store/{storeid}/order/{orderid}/rmareq-guest"]			
		};
		
		var ts_cache = 600000;
		
		var handlelocalstoragedesync = false;
		
		if (handlelocalstoragedesync && islocalstoragesupported()) {
			if (getcookie("parentdomain")) {
				//si existe el parentdomain en la cookie pero no en el localstorage, o si el valor almacenado en la cookie es distinto al almacenado en el localstorage,
				//quiere decir que el navegador no est√° compartiendo el localstorage entre http y https.
				if (!localstorage.getitem("parentdomain") || getcookie("parentdomain") !== localstorage.getitem("parentdomain")) {
					localstorage.removeitem("cache-shop-cart");
					setcookie("parentdomain", document.referrer, undefined);
					localstorage.setitem("parentdomain", document.referrer);
				}
			} else {
				setcookie("parentdomain", document.referrer, undefined);
				localstorage.setitem("parentdomain", document.referrer);
			}
		}
		
		var ispersistcartcouchbaseenabled = false;
		var safecartservicetimeout = 5000;
		
		var dummyuserjson = {
			    "identity": {
			        "userid": -1002,
			        "wctoken": null,
			        "wctrustedtoken": null,
			        "wcpersistent": null
			    },
			    "primaryaddressid": null,
			    "email": null,
			    "firstname": null,
			    "middlename": null,
			    "lastname": null,
			    "usertype": "g",
			    "iswalletuser": null,
			    "isshippingwalletvalid": null,
			    "hassecurepassword": null,
			    "userlanguage": null,
			    "rememberme": null,
			    "shopcart": {
			        "id": null,
			        "isnonexus": null,
			        "status": null,
			        "totalorder": null,
			        "totalproduct": null,
			        "totaladjustment": null,
			        "adjustment": null,
			        "promotion": null,
			        "tax": null,
			        "shippingprice": null,
			        "shippingtax": null,
			        "items": [],
			        "taxarray": null,
			        "shippingtaxarray": null
			    },
			    "wishcart": {
			        "id": null,
			        "items": []
			    },
			    "pendingtransfers": null,
			    "restrictedbooking": null,
			    "personaldatalevel": null,
			    "isbuyer": null
			};
		
		function message(event) {
			
			var origin = event.origin;
			var data = event.data;
			
			if (event.source == parent) {
				
				if (!(new regexp("(http|https)://" + location.hostname + "(:[0-9]+)?").test(origin))){
	      			return;
	      		}
	      			      		
				onmessage(json.parse(data), function(json) {
					window.parent.postmessage(json.stringify(json), origin);
				});
			}
		}
		
		function onmessage(json, callback) {
	      	var json;
	      			
	      	ispersistcartcouchbaseenabled = json.isafecartenabled;		
	      	
	      	if ((json.action == "set") || (json.action == "get")) {
	      		storage(json, callback);
	      	} else if (/^(http|https):/.test(json.action)) {
	      		json.url = json.action.replace("http:", "https:");
	  			json.method = "get";
	  			ajax(json, function(){
	      			callback(json);
	     		});
	      	} else if (restmap[json.action]) {
	      		json.sendrequest = true;
	      		json.status = 1;
	      		processprerestaction(json, function() {
	       			json.contenttype = "application/json"; 
	       			if (json.sendrequest == true){
		        		rest(json, function(){ 
		        			processpostrestaction(json, function() {
		        				callback(json);
		        			});		 		        				
		        		});
	       			} else {
	       				processpostrestaction(json, function() {
	        				callback(json);
	        			});
	       			}
	       		});	        				
	      	} else {
	      		json.status = 0;
				json.value = null;
				callback(json);
	      	}
		}
						
		function rest(request, finish) {
			var url, t, k, v, params, flag, re, i;
			
			params = request.params || {};
			if (request.appid) {
				params.appid = request.appid;
			} else {
				params.appid = appid;
			}
			if(request.js_return){
				request.data.jsreturn = request.js_return
			}
	
			url = restmap[request.action][1];
			
			while (t = pattern_var.exec(url)) {
				k = t[0].slice(1, -1);
				v = params[k];
				
				if (v == undefined) {
					request.status = 404;
					if (typeof finish == "function"){
						finish();
					}
					return;
				}
				
				url = url.replace(t[0], v);
				delete params[k];
			}
			
			if (restmap[request.action].length > 2 && restmap[request.action][2]) {
				if (params["ts"] == undefined) {
					params.ts = new date().gettime();
				}
			}
			
			flag = true;
			for (k in params) {
				if (typeof params[k] === "object") {
					t = params[k];
				} else {
					t = [params[k]];
				}
				
				for (i = 0; i < t.length; i++) {
					url += flag ? "?" : "&";
					flag = false;
					url += encodeuricomponent(k);
					url += "=";
					url += encodeuricomponent(t[i]);
				}
			}
			
			request.url = url;
			request.method = restmap[request.action][0];					
			ajax(request, function(){
				//miramos si es un error de sesiÔøΩn expirada y redirigimos a la pÔøΩgina de sesiÔøΩn expirada
				if (request.value && request.value.code && request.value.code == 4){
					request.sessionexpired = true;					
					dummyuserjson.storeid = request.storeid;
					dummyuserjson.timestamp = 0;
					request.userjson = dummyuserjson;
					setsessionstorage("cache-current-user", dummyuserjson);
					
				}
				
				if (typeof finish == "function"){
					finish();
				}
			});
			
		}
	
		function ajax(request, finish){
			var xmlhttp, type, k;
	
			xmlhttp = new xmlhttprequest();
			xmlhttp.open(request.method, request.url);
			if (request.contenttype) {
				xmlhttp.setrequestheader("content-type", request.contenttype);
			}
			if (request.timeout) {
				xmlhttp.timeout = request.timeout;
			}
			
			xmlhttp.onreadystatechange = function(){
				
				if (xmlhttp.readystate == 4) {
					try {
						if ((xmlhttp.status == 200) || (xmlhttp.status == 201) || (xmlhttp.status == 202)) {
							request.status = 1;
						} else {
							request.status = 0;
						}
						
						type = xmlhttp.getresponseheader('content-type');
						if (type && (type.indexof("json") != -1)) {
								request.value = json.parse(xmlhttp.responsetext);
						} else {
							request.value = xmlhttp.responsetext;
						}
					} catch (err) {
						request.status = 0;
						request.value = null;
					}
																
					if (typeof finish == "function"){
						finish();
					}
				}
			};
			
			if (request.headers){
				for(k in request.headers){
					xmlhttp.setrequestheader(k, request.headers[k]);
				}
			}
			
			if (request.data){
				xmlhttp.send(json.stringify(request.data));
			} else {
				xmlhttp.send();
			}
			
		}
		
		//inicio - gestion casos especiales
		function processprerestaction(json, finish){
			
			var pendingdata = getpendingdata(json.storeid);
			
			if ((json.action == "user:login")
				|| (json.action == "user:register")
				|| (json.action == "user:logout")
				|| (json.action == "wishlist:wishlistbyuser")
				|| (json.action == "wishlist:wishlistbyid")) {
					persistcartstoserver(pendingdata, json, function(){
						finish();
					});				
			} else if (json.action == "user:currentuser") {							
				processcurrentuser(pendingdata, json, function(){
					json.sendrequest = false;
					json.value = json.userjson;
					finish();
				});
			} else if (json.action == "order:shoppingcart"
					|| json.action == "order:minicart") {							
				processshoppingcart(pendingdata, json, function(){
					json.sendrequest = false;
					json.value = json.shopcartjson;
					finish();
				});
			} else if (json.action == "order:addtocart") {							
				proccessaddtocart("shopcart", json, pendingdata, function(){
					json.sendrequest = false;
					finish();
				});
			} else if (json.action == "wishlist:addtowishlist") {
				proccessaddtocart("wishcart", json, pendingdata, function(){
					json.sendrequest = false;
					finish();
				});
			} else if (json.action == "catalog:productdetail") {
				 if (json.params && json.params.categoryid) {
				 	json.params.categoryid = 0;
				 }
				 finish();
			}else {
				finish();
			}											
		}
		
		function processpostrestaction(json, finish){
			
			var callbacks = [];
			
			if ((json.updateuserjson)	
					|| (json.action == "user:register")				
					|| (json.action == "user:logout")								
					|| (json.action == "user:updateuseremail")
					|| (json.action == "user:addupdateaddress")
					|| (json.action == "wallet:deletecard")
					|| (json.action == "wallet:savewalletdata")
					|| (json.action == "wallet:deletewalletdata")				
					|| (json.action == "wishlist:updatewishlist")
					|| (json.action == "giftcard:addphysicalgiftcardtoshopcart")
					|| (json.action == "giftcard:addvirtualgiftcardtoshopcart")
					|| (json.action == "user:deleteaddress")
					|| (json.action == "user:updateuserpassword")
					|| (json.action == "user:updateresetuserpassword")){				
				callbacks.push( function(json, onfinish) {
						getfromserver("userjson", json, function(){
							processuserjson(json.userjson, json.storeid);
							if(json.updateshopcart) {
								processshopcartjson(json.userjson.shopcart, json.storeid);
								json.value = json.userjson.shopcart;
							}
							onfinish();
						});
					});
			} 
			
			if (json.action == "user:login") {
				if (ispersistcartcouchbaseenabled && json.value.identity) {
					callbacks.push( function(json, onfinish) {
						getcartfromcouchbase(json.value.identity.userid, json.storeid, function(couchbasejson) {
							if (couchbasejson && couchbasejson.shopcart && couchbasejson.wishcart) {
								var pendingdata = getpendingdata(json.storeid);
								updateitemscart(pendingdata, "shopcart", couchbasejson.shopcart.items);
								updateitemscart(pendingdata, "wishcart", couchbasejson.wishcart.items);
								persistcartstoserver(pendingdata, json, function(){
										deletecartfromcouchbase(json.value.identity.userid, json.storeid, function(){
											getfromserver("userjson", json, function(){
												processuserjson(json.userjson, json.storeid);
												if(json.updateshopcart) {
													processshopcartjson(json.userjson.shopcart, json.storeid);
													json.value = json.userjson.shopcart;
												}
												onfinish();
											});
										});
									});
							} else {
								if (json.status == 1) {
									json.userjson = json.value;
								}
								processuserjson(json.userjson, json.storeid);
								if(json.updateshopcart) {
									processshopcartjson(json.userjson.shopcart, json.storeid);
									json.value = json.userjson.shopcart;
								}
										onfinish();
							}
						});
					});
				} else {
					callbacks.push( function(json, onfinish) {
						if (json.status == 1) {
							json.userjson = json.value;
						}
						processuserjson(json.userjson, json.storeid);
						if(json.updateshopcart) {
							processshopcartjson(json.userjson.shopcart, json.storeid);
							json.value = json.userjson.shopcart;
						}
						onfinish();
					});
				}
			}
			
			if (json.updateshopcart && !json.updateuserjson){
				callbacks.push( function(json, onfinish){
					//actualizo el json desde el servidor
					getfromserver("shopcartjson", json, function(){
						processshopcartjson(json.shopcartjson, json.storeid);
						json.userjson = getsessionstorage("cache-current-user");
						json.value = json.shopcartjson;
						onfinish();
					}); 
				});
			}
			
			if ((json.action == "order:updatecart")
				|| (json.action == "order:deletefromcart")){
				callbacks.push( function(json, onfinish) {
					//se hace un current-user para traer lo que tengamos 
					// en el carrito persistido.
				    var pendingdata = getlocalstorage("cache-pending-data");
				    var shopcartjson = getlocalstorage("cache-shop-cart");	
				    //comprobamos que no hay ningun articulo sin pesistir. si
				    // es asi, se persiste el carrito.
					if(pendingdata!=null && (shopcartjson != null && pendingdata.timestamp != shopcartjson.timestamp)) {
							shopcartjson.timestamp = 1;
							processshoppingcart(pendingdata, shopcartjson, function(){
							});
						}
					//ahora que el carrito est√° persistido, nos traemos
					// el usuario con el carrito actualizado.
					getfromserver("userjson", json, function(){
						processuserjson(json.userjson, json.storeid);
						var shopcartjson = json.userjson.shopcart;
						var pendingdata = getlocalstorage("cache-pending-data");
						
						setlocalstorage("cache-shop-cart", shopcartjson);						
						if (pendingdata) {
							pendingdata.timestamp = 0;
						}
						setlocalstorage("cache-pending-data", pendingdata);
						
						
						processshopcartjson(shopcartjson, json.storeid);
						onfinish();

					});
				});
			}
			if ((json.action == "order:addgiftpacking")
				|| (json.action == "order:getgiftticket")
				|| (json.action == "order:deletegiftpacking")
				|| (json.action == "order:cardsadjustments")
				|| (json.action == "order:deletecardsadjustments")				
				|| (json.action == "order:orderconfirmation")
				|| (json.action == "order:addpromocode")
				|| (json.action == "giftcard:updatephysicalgiftcarddata")
				|| (json.action == "giftcard:updatevirtualgiftcarddata")
				|| (json.action == "giftcard:addphysicalgiftcardtoshopcart")
				|| (json.action == "giftcard:addvirtualgiftcardtoshopcart")
				|| (json.action == "wishlist:addwishlisttoorder")
				|| (json.action == "order:asyncrepay")
				|| (json.action == "order:checkoutshipping")
				|| (json.action == "order:deletepromocode")
				|| (json.action == "order:paymentstatus")
				|| (json.action == "order:unboundpayment")
				|| (json.action == "wallet:orderpreview")
				|| (json.action == "user:login")
				|| (json.action == "user:register")				
				|| (json.action == "user:logout")){
				callbacks.push( function(json, onfinish){
					//solo actualizo el timestamp
					var shopcartjson = getlocalstorage("cache-shop-cart");
					if (shopcartjson){
						shopcartjson.timestamp = 0;
						setlocalstorage("cache-shop-cart", shopcartjson);
					}
					onfinish();
				});
				
			} 

			if (json.action == 'user:register'
				|| json.action == 'user:login'
				|| json.action == 'user:currentuser') {
				callbacks.push(function(json, onfinish) {
					persistcbwishlisttoserver(function(){
						onfinish();
					});
				});
				callbacks.push(function(json, onfinish) {
					if (json && json.userjson && json.userjson.shopcart && json.userjson.shopcart.items && json.userjson.shopcart.items.length == 0) {
						setlocalstorage("cache-shop-cart", json.shopcart);
					}
					onfinish();
				});
			}			
			
			processcallbacks(callbacks, json, finish);
			
		}
		
		function processcallbacks(callbacks, json, finish){
			if (callbacks.length > 0){
				var callback = callbacks.shift();
				if (typeof callback === "function"){
					callback(json, function(){
						processcallbacks(callbacks, json, finish)
						});
				}
			} else {
				finish();
			}
		}
		
		
		function persistcartstoserver(pendingdata, json, finish){
			persistcarttoserver("shopcart", pendingdata, json, function (){
				persistcarttoserver("wishcart", pendingdata, json, function (){											
					if (ispersistcartcouchbaseenabled) {
						var	userjson = getsessionstorage("cache-current-user");
						if (userjson && userjson.usertype === "r") {
							deletecartfromcouchbase(userjson.identity.userid, json.storeid, finish);
						} else {
							finish();
						}
					} else {
						finish();
					}
				});
			});
			
		}

		function persistcbwishlisttoserver(finish) {
			var userjson = getsessionstorage("cache-current-user");
			var wishlists = getlocalstorage('user_wishlists');
			if (!wishlists || !wishlists.wlarray | !userjson | (userjson.usertype !== 'r')) {
				finish();
				return;
			}
			var action = {
				'action': 'cb:savewishlists',
				'params': {
					'storeid': inditex.istoreid,
					'languageid': inditex.ilangid,
					'catalogid': inditex.icatalogid,
				},
				'data': wishlists
			};
			action.contenttype = 'application/json';
			rest(action, function(){
				if (action.status == 1){
					setlocalstorage('user_wishlists', null);										
				}
				finish();
			});	
		};
		
		function persistcarttoserver(typecart, pendingdata, json, finish){
	
			var cart = {
					"cartitems": []
					};					
			
			for (var i = 0; i< pendingdata[typecart].items.length; i++){
				var item = {
					"sku": pendingdata[typecart].items[i].sku,
					"quantity": pendingdata[typecart].items[i].quantity,
					"categoryid": pendingdata[typecart].items[i].categoryid,
					"categorytype": pendingdata[typecart].items[i].categorytype,
					"parentid": pendingdata[typecart].items[i].parentid,
					"productid": pendingdata[typecart].items[i].productid,
					"style": pendingdata[typecart].items[i].style,
					"color": pendingdata[typecart].items[i].color
				};
				cart.cartitems.push(item);
			}								
			//aÔøΩadimos los items actuales (si hay)
			if (((typecart === "shopcart" && json.action === "order:addtocart") || (typecart === "wishcart" && json.action === "wishlist:addtowishlist")) && json !=null && json.data!=null && json.data.cartitems!=null && json.data.cartitems.length>0){
				
				for (var i = 0; i<json.data.cartitems.length; i++){
					cart.cartitems.push({
						"sku": json.data.cartitems[i].sku,
						"quantity": json.data.cartitems[i].quantity,
						"categoryid": json.data.cartitems[i].categoryid,
						"categorytype": json.data.cartitems[i].categorytype,
						"parentid": json.data.cartitems[i].parentid,
						"productid": json.data.cartitems[i].productid,
						"style": json.data.cartitems[i].style,
						"color": json.data.cartitems[i].color
						}
					);
				}
			}		
			
			if (cart.cartitems.length>0){												
				
				var action = null;
				
				//delete the pending data from the current cart localstorage
				pendingdata[typecart] = {"items":[]};					
				setlocalstorage("cache-pending-data", pendingdata);
				
				if (typecart == "wishcart"){
					action = "wishlist:addtowishlist";					
				}
				
				if (typecart == "shopcart"){
					action = "order:addtocart";					
				}
				
				//needs to user json
				json.updateuserjson = true;
				
				//persisto los datos de la cesta de la compra		
				var mydata = {
						"action": action,
						"params": {
							"storeid": json.storeid,
							"languageid": json.languageid ? json.languageid : -1
							},
						"data": cart
					};
				
				mydata.contenttype = "application/json";
					
				rest(mydata, function(){					
					finish();							    					
				});
			} else {
				finish();
			}
		};
		
		
		function getfromserver(jsonname, json, finish){
			//recuperamos el json del servidor
			
			var action = null;
			
			if (jsonname === "userjson"){
				action = "user:currentuser";
			} else if (jsonname === "shopcartjson") {
				action = "order:shoppingcart";
			}
			
			var mydata = {
					"action": action,
					"params": {
						"storeid": json.storeid,
						"languageid": json.languageid
						}
				};
			
			mydata.contenttype = "application/json";
				
			rest(mydata, function(){
				if (mydata.status == 1){
					json[jsonname] = mydata.value;
					json[jsonname].storeid = json.storeid;
					json[jsonname].timestamp = new date().gettime();
					if (jsonname === "userjson"){
						setsessionstorage("cache-current-user", json[jsonname]);
					} else if (jsonname === "shopcartjson") {
						setlocalstorage("cache-shop-cart", json[jsonname]);						
					}					
				}
				finish();
			});
		}
		
		function persistcarttocouchbase(userid, pendingdata, storeid, finish){											
				
			var action = "cb:safecart";
			
			//persisto los datos de la cesta de la compra		
			var mydata = {
				"action": action,
				"params": {
					"userid": userid,
					"storeid": storeid
				},
				"data": pendingdata,
				"timeout": safecartservicetimeout
			};
			
			mydata.contenttype = "application/json";
				
			rest(mydata, function(){
				finish();
			});
		};
		
		function getcartfromcouchbase(userid, storeid, finish){
			
			var action = "cb:getcart";
			
			var mydata = {
				"action": action,
				"params": {
					"userid": userid,
					"storeid": storeid
				},
				"timeout": safecartservicetimeout
			};
			
			mydata.contenttype = "application/json";
				
			rest(mydata, function(){
				finish(mydata.value);
			});
		};
		
		function deletecartfromcouchbase(userid, storeid, finish){
			
			var action = "cb:deletecart";
			
			var mydata = {
				"action": action,
				"params": {
					"userid": userid,
					"storeid": storeid
				},
				"timeout": safecartservicetimeout
			};
			
			mydata.contenttype = "application/json";
				
			rest(mydata, function(){
				finish();
			});
		};
		
		function updatecouchbasecart(pendingdata, userjson, typecart, itemsadded, finish){
			if (userjson && userjson.usertype === "r") {
				getcartfromcouchbase(userjson.identity.userid, userjson.storeid, function(couchbasejson) {
					if (couchbasejson && couchbasejson[typecart]) {
						updateitemscart(couchbasejson, typecart, itemsadded);
						updateitemscartfromcouchbase(pendingdata, typecart, couchbasejson[typecart].items);
						updateitemscartfromcouchbase(userjson, typecart, couchbasejson[typecart].items);
						updatetimestampforjsons([userjson, pendingdata], new date().gettime());
						storecachejsons(pendingdata, userjson);
					} 
					persistcarttocouchbase(userjson.identity.userid, pendingdata, userjson.storeid, function() {
						finish();
					});
				});
			} else {
				finish();
			}
		}
		
		function updateitemscart(value, carttype, cartitems){
			
			var found = false;
			if (cartitems!=null && cartitems.length>0 && value != null && value[carttype] != null && value[carttype].items != null){
				//buscamos a ver si estaba aÔøΩadido en el array
				var cart = value[carttype];
				for (var i = 0; i< cartitems.length; i++){
					for (var j = 0 ; j < cart.items.length; j++) {
						if (cartitems[i].sku == cart.items[j].sku){
							cart.items[j].quantity += cartitems[i].quantity;
							found = true;
							if (cart.items[j].quantity == 0){
								//eliminamos el item del array
								cart.items.splice(j,1);
							}
						}
					}
					if (!found){
						//aÔøΩadimos item al array
						value[carttype].items.push(cartitems[i]);
					} else {
						found = false;
					}
				}
			} else {
				value[carttype] = {"items" : []};
			}			
		};
		
		function updateitemscartfromcouchbase(value, carttype, cartitems){
			
			var found = false;
			if (cartitems!=null && cartitems.length>0 && value != null && value[carttype] != null && value[carttype].items != null){
				var cart = value[carttype];
				for (var i = 0; i< cartitems.length; i++){
					for (var j = 0 ; j < cart.items.length; j++) {
						if (cartitems[i].sku == cart.items[j].sku){
							cart.items[j].quantity = cartitems[i].quantity;
							found = true;
						}
					}
					if (!found){
						value[carttype].items.push(cartitems[i]);
					} else {
						found = false;
					}
				}
			} else {
				value[carttype] = {"items" : []};
			}			
		};
		
		function updatetimestampforjsons(jsonarray, timestamp){			
			
			for (var i = 0; i< jsonarray.length; i++){
				if (jsonarray[i]){
					jsonarray[i].timestamp = timestamp;
				}
			}
		};
		
		function storecachejsons(pendingdata, userjson, shopcartjson){					
						
			if (pendingdata){
				setlocalstorage("cache-pending-data", pendingdata);
			}
			if (userjson){
				setsessionstorage("cache-current-user", userjson);
			}
			if (shopcartjson){
				setlocalstorage("cache-shop-cart", shopcartjson);
			}
		};
		
		function proccessaddtocart(typecart, json, pendingdata, finish){
			
			var	userjson = getsessionstorage("cache-current-user");
								
			json.userjson = userjson;
			
			if (pendingdata!=null && pendingdata.storeid == json.storeid && userjson!=null
					&& pendingdata.timestamp == userjson.timestamp) {						
				//es una operaciÔøΩn de aÔøΩadir a la cesta
					if (json.data!=null){
						
						//actualizamos json de usuario
						updateitemscart(userjson, typecart, json.data.cartitems);
						//actualizamos pending data
						updateitemscart(pendingdata, typecart, json.data.cartitems);
				
						updatetimestampforjsons([userjson, pendingdata], new date().gettime());
						if (userjson) {
							userjson.storeid = json.storeid;
						}
						storecachejsons(pendingdata, userjson);
						if (ispersistcartcouchbaseenabled) {
							updatecouchbasecart(pendingdata, userjson, typecart, json.data.cartitems, finish);
						} else {
							finish();
						}
					} else {
						finish();
					}						
			} else {
				if ((pendingdata!=null && pendingdata.storeid == json.storeid && 
						userjson!=null && pendingdata.timestamp != userjson.timestamp) || (userjson == null)){
					persistcartstoserver(pendingdata, json, function() {
						updatetimestampforjsons([userjson, pendingdata], new date().gettime());
						if (userjson) {
							userjson.storeid = json.storeid;
						}
						storecachejsons(pendingdata, userjson);
						finish();
					});
				}
			}
		}
		
		function getlocalstorage(key){
			try{
				return json.parse(localstorage.getitem(key));
			} catch (e){						
			}
		}
		
		function setlocalstorage(key, value){
			try {
				localstorage.setitem(key, json.stringify(value));						
			} catch (err) {						
			}
		}
		
		function islocalstoragesupported(){
			try {
				localstorage.setitem('test', 'test');
				localstorage.removeitem('test');
				return true;						
			} catch (err) {						
				return false;
			}
		}
		
		function getsessionstorage(key){
			try{
				return json.parse(sessionstorage.getitem(key));
			} catch (e){						
			}
		}
		
		function setsessionstorage(key, value){
			try{
				sessionstorage.setitem(key, json.stringify(value));
			} catch (e){						
			}
		}
		
		function getcookie(name) {
			var cookies = document.cookie.split(";");
			var i, key, value, index;
		
			for (i = 0; i < cookies.length; i++) {
				index = cookies[i].indexof("=");
				key = cookies[i].substr(0, index).replace(/^\s+|\s+$/g, "");
				value = cookies[i].substr(index + 1);
				if (key == name) {
					return decodeuricomponent(value);
				}
			}
		
			return null;
		};
		
		function setcookie(name, data, expiresin) {
			var expires;
			if (expiresin != undefined) {
				var date = new date();
				date.settime(date.gettime() + (expiresin * 24 * 60 * 60 * 1000));
				expires = "; expires=" + date.togmtstring();
			}
			if (expires != undefined) {
				document.cookie = name + "=" + encodeuricomponent(data) + expires + "; path=/";
			} else {
				document.cookie = name + "=" + encodeuricomponent(data) + "; path=/";
			}
		};
		
		function getpendingdata(storeid) {
			var dummypendingdata = {
					"timestamp" : new date().gettime(),
					"storeid": storeid,
					"shopcart": {"items": []},
					"wishcart": {"items": []}
				};
			
			var pendingdata = getlocalstorage("cache-pending-data");
			if (null == pendingdata || pendingdata.storeid != storeid) {
				pendingdata = dummypendingdata;
			}
			
			return pendingdata;
		}
		
		function getlocalcartjson(storeid) {
			var dummycartjson = {  
					   "timestamp":0
					};
			
			var cartjson = getlocalstorage("cache-shop-cart");
			if (null == cartjson || cartjson.storeid != storeid) {
				cartjson = dummycartjson;
			}
			
			return cartjson;
		}
		
		function getlocaluserjson(storeid) {
			var userjson = getlocalstorage("cache-current-user");
			if (null == userjson || userjson.storeid != storeid) {
				userjson = dummyuserjson;
			}
			
			return userjson;
		}
				

		
		function processshoppingcart(pendingdata, json, finish){
			
			var shopcartjson = getlocalstorage("cache-shop-cart");
			
			if (!shopcartjson){
				shopcartjson = {};
			}
			
			if (pendingdata!=null && (shopcartjson != null && pendingdata.timestamp != shopcartjson.timestamp)){
				persistcartstoserver(pendingdata, json, function() {
					json.updateshopcart = true;					
					finish();
				});
			} else {				
				if (shopcartjson != null && ((new date().gettime() - shopcartjson.timestamp) < ts_cache) && (shopcartjson.storeid == json.storeid)) {															
					json.shopcartjson = shopcartjson;
					finish();				
				} else {
					json.updateshopcart = true;
					finish();
				}												
			}			
		}		
		
		function processcurrentuser(pendingdata, json, finish){	
			
			var userjson = getsessionstorage("cache-current-user");
			if (!userjson){
				userjson = {};
			}
			
			if (pendingdata!=null && (userjson != null && pendingdata.timestamp != userjson.timestamp)){				
				persistcartstoserver(pendingdata, json, function() {
 					json.updateuserjson = true;
					finish();
				});
			} else {				
				if (userjson != null && ((new date().gettime() - userjson.timestamp) < ts_cache) && (userjson.storeid == json.storeid)){							
					json.userjson = userjson;
					finish();					
				} else {
					json.updateuserjson = true;
					finish();
				}												
			}			
		}
		
		function processuserjson(userjson, storeid){
			pendingdata = getpendingdata(storeid);
			var timestamp = new date().gettime();
			if ((new date().gettime() - pendingdata.timestamp) < ts_cache){
				timestamp = pendingdata.timestamp;
			}
			updatetimestampforjsons([userjson, pendingdata], timestamp);
			if (userjson) {
				userjson.storeid = storeid;
			}
			storecachejsons(pendingdata, userjson);	
		};
		
		
		function processshopcartjson(shopcartjson, storeid){
			pendingdata = getpendingdata(storeid);
			var userjson = getsessionstorage("cache-current-user");
			if (userjson){
				userjson.shopcart = shopcartjson;				
			}
			var timestamp = new date().gettime();
			if ((new date().gettime() - pendingdata.timestamp) < ts_cache){
				timestamp = pendingdata.timestamp;
			}
			updatetimestampforjsons([shopcartjson, pendingdata, userjson], timestamp);
			shopcartjson.storeid = storeid;
			storecachejsons(pendingdata, userjson, shopcartjson);	
		};
		
		//fin - gestion casos especiales
		
		function storage(request, callback) {
			if (request.action == "get") {
				try {
					request.value = json.parse(localstorage.getitem(request.key));
					request.status = 1;
				} catch (err) {
					request.value = null;
					request.status = 0;
				}
			} else if (request.action == "set") {
				try {
					localstorage.setitem(request.key, json.stringify(request.value));
					request.status = 1;
				} catch (err) {
					request.status = 0;
				}
			}
			
			callback(request);
		}
	
			inditex.postmessage = function(data, callback) {
				onmessage(json.parse(data), callback);
			};
		
	})();
	
</script>
	
	<script type="text/javascript">
		inditex.initialize(null, false);
	</script>
	</body>
</html>


<!-- begin monitor -->
<!--tagpagename="itxproductpage"-->
<!--itxstoreid="leftiessa"-->
<!--itxstorelang="en"-->
<!--itxstoretype="no_venta"-->
<!-- end monitor -->

